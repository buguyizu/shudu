<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>ants</title>
<script type="text/javascript" language="javascript">
function ant(element) {

	this.element=element;
	this.moveUnit="px";
	this.speed=20;//getRnd(10,12);
	this.enabled=true;

	this.angle=0;
	this.radian=0;
	this.X=0;
	this.Y=0;

	this.element.style.color="RGB("+getRnd(0,255)+","+getRnd(0,255)+","+getRnd(0,255)+")";

	function getRnd(l,u) {
		return parseInt((u-l+1)*Math.random()+l);
	}
	function getReflectAngle(thisAngle, thatAngle) {
		return thatAngle * 2 - thisAngle;
	}

	this.setAngle=function(angle) {
		this.angle=angle;
		this.radian=this.angle*Math.PI/180;
		this.X=this.speed*Math.cos(this.radian);
		this.Y=this.speed*Math.sin(this.radian);
	};

	this.setAngle(getRnd(0,360));

	this.move=function() {

		var s=this;
		this.element.onmouseout=function() {
			if (s.enabled) {
				s.enabled=false;
				s.element.style.borderWidth="2px";
			} else {
				s.enabled=true;
				s.element.style.borderWidth="1px";
			}
		};

		this.element.ondrag=function() {
			s.element.style.left=s.element.offsetLeft+event.offsetX+s.moveUnit;
			s.element.style.top=s.element.offsetTop+event.offsetY+s.moveUnit;
		};

		var x=0;
		var y=0;

		if (this.element.offsetLeft+this.X<=0) {
			x=0-this.element.offsetLeft;
		} else if (this.element.offsetLeft+this.X>=this.element.offsetParent.clientWidth-this.element.offsetWidth) {
			x=this.element.offsetParent.clientWidth-this.element.offsetWidth-this.element.offsetLeft
		} else {
			x=this.X;
		}

		if (this.element.offsetTop+this.Y<=0) {
			y=0-this.element.offsetTop;
		} else if (this.element.offsetTop+this.Y>=this.element.offsetParent.clientHeight-this.element.offsetHeight) {
			y=this.element.offsetParent.clientHeight-this.element.offsetHeight-this.element.offsetTop;
		} else {
			y=this.Y;
		}

		if (x!=this.X) {
			if (y==this.Y) {
				y=x*Math.tan(this.radian);
			}
			this.setAngle(getReflectAngle(this.angle, 90));
		} else if (y!=this.Y) {
			if (x==this.X) {
				x=y/Math.tan(this.radian);
			}
			this.setAngle(getReflectAngle(this.angle, 0));
		}

		if (this.enabled) {
			this.element.style.left=this.element.offsetLeft+x+this.moveUnit;
			this.element.style.top=this.element.offsetTop+y+this.moveUnit;
		}

	};
};


var n=1;
var ants = new Array();
var count=1;
var noPause="1";
var createTagName="P";

function startMove() {

	for(var i=0; i<count;i++){
		var newNode=document.createElement(createTagName);
		document.getElementById("div1").appendChild(newNode);
		newNode.style.position="absolute";
		newNode.style.left="0px";
		newNode.style.top="0px";
		newNode.style.width="20px";
		newNode.style.height="20px";
		newNode.style.borderStyle="solid";
		newNode.style.borderWidth="1px";
	}

	for(var i=0; i<document.getElementsByTagName(createTagName).length;i++){
		ants[i] = new ant(document.getElementsByTagName(createTagName)[i]);
	}

	repeat();
	document.getElementById("button1").disabled="disabled";
}

function pauseMove() {
	if (noPause) {
		noPause=null;
	} else {
		noPause="1";
	}
}

function repeat(){
	if (noPause) {
		for(var i=0; i<ants.length;i++){
			if (ants[i]!=null && n!=1){
				ants[i].move();
			}
		}
	} else {
		n--;
	}
	if (n>0 && n<50) {
		window.setTimeout("repeat()", 200);
	}
	n++;
}
</script>
</head>
<body>
	<input type="button" id="button1" value="start"	onclick="startMove();"></input>
	<input type="button" id="button2" value="pause" onclick="pauseMove();"></input>
	<div id="div1" style="position:absolute;left:50px;top:100px;width:500px;height:300px;border-style:solid;border-width:1px;"></div>
	<a href="ocx\Project1.HTM">vbtest</a>
</body>
</html>
